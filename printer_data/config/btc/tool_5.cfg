#TOOL 1 CONFIGURATION
#Hardware:
# V6 CHP
# Sherpa Micro
# EBB36 V1.2
# 3010 hotend fan
# dual 4010 part cooling fan

####################
# Tool1 Variables
[gcode_macro _Variables_t5]
variable_pickuplocation_x:      344   # X Dock position for pickup move
variable_dropofflocation_x:     344    # X Dock position for dropoff move

variable_xoffset: -0.38 #-0.37       .       # For tool 0, offsets are all 0
variable_yoffset: 0.48 #0.45              #
variable_zoffset: 0.10 #-0.38              #
variable_shaperfreq_x: 86.000      # Tool 0 input shaper
variable_shaperfreq_y: 42.800     #
variable_shapertype_x: "2hump_ei"     #
variable_shapertype_y: "mzv"      #
variable_pressure_advance: 0.02      # pressure advance
variable_pressure_advance_smooth_time: 0.02      # pressure advance smooth time

# End of section options
#######################################################

variable_last_press: 0
gcode:

##### Neopixel #######################################
# Uncomment the following if you're using neopixel
#include ./leds_1.cfg]
######################################################

###################################################################
# These 2 senses pins provides actual physical location of toolhead
[gcode_button carriagesense_t5]
pin: ^toolboard5: PB9
press_gcode:
  #_tool_off_carriage TOOLNUMBER=1
release_gcode:
  #_tool_on_carriage TOOLNUMBER=1

#Specify which serial device this tool is:
[mcu toolboard5]
canbus_uuid: 71f5693809e5 #b6a4207424ab #c9455f12eba6

[extruder5]
step_pin: toolboard5: PD0
dir_pin: !toolboard5: PD1
enable_pin: !toolboard5: PD2
microsteps: 16
rotation_distance: 4.1665 #5 #5.5
nozzle_diameter: 0.400
filament_diameter: 1.750
heater_pin: toolboard5: PB13
sensor_type: EPCOS 100K B57560G104F
sensor_pin: toolboard5: PA3
control: pid
pid_Kp: 18.004
pid_Ki: 0.834
pid_Kd: 97.223
min_temp: 0
max_temp: 300
#PID parameters: pid_Kp=18.004 pid_Ki=0.834 pid_Kd=97.223
# sensor_type:MAX31865
# sensor_pin: EBBCan: PA4
# spi_bus: spi1
# rtd_nominal_r: 100
# rtd_reference_r: 430
# rtd_num_of_wires: 2

[tmc2209 extruder5]
uart_pin: toolboard5: PA15
run_current: 0.650
stealthchop_threshold: 999999

#extruder setup
[fan_generic partfan5]
pin: toolboard5: PA1
max_power: 1.0
#shutdown_speed:
#cycle_time:
#hardware_pwm:
kick_start_time: 0.5
off_below: 0.1
#tachometer_pin:
#tachometer_ppr:
#tachometer_poll_interval:
#enable_pin:
[heater_fan hotend_fan5]
pin: toolboard5: PA0
heater: extruder5
heater_temp: 40.0
#hotend fan
#accelerometer pins

#[adxl345 toolboard0]
#cs_pin: toolboard0: PB12
#spi_software_sclk_pin: toolboard0: PB10
#spi_software_mosi_pin: toolboard0: PB11
#spi_software_miso_pin: toolboard0: PB2
#axes_map: x,y,z

[adxl345 toolboard5]
cs_pin: toolboard5: PB12
spi_software_sclk_pin: toolboard5: PB10
spi_software_mosi_pin: toolboard5: PB11
spi_software_miso_pin: toolboard5: PB2
axes_map: x,y,z


#[temperature_sensor Tool0]
#ensor_type: MAX31865
#sensor_pin: toolboard0: PA4

[resonance_tester]
accel_chip: adxl345 toolboard5
probe_points:
    175, 175, 20  # an example for a 350mm printer

#[probe]
##sensor_pin: ^EBBCan:gpio06
##control_pin: EBBCan:gpio22
##pin: ^EBBCan:gpio6
#pin: PD13 #^EBBCan:gpio22
#x_offset: 0
#y_offset: 25.0
#z_offset: 8.85
#z_offset_min: -2.0
#z_offset_max: 2.0
#speed: 10.0
#samples: 3
#samples_result: median
#sample_retract_dist: 3.0
#samples_tolerance: 0.006
#samples_tolerance_retries: 3
### NPN and PNP proximity switch types can be set by jumper
##[probe]
##pin: ^EBBCan:gpio6

[gcode_arcs]
resolution: 0.1

#[temperature_sensor Tool0]
#sensor_type: MAX31865
#sensor_pin: toolboard0: PA4

#tool 1 has the bltouch probe
#[bltouch]
#sensor_pin: ^toolboard_1:bltouch_sensor_pin
#control_pin: toolboard_1:bltouch_control_pin
#z_offset: 3.375 #(if a negative z offset is required to reach zero then add the offset to this number) add -0.07 on 30/06/2024 3.355 -> 3.425 subract 0.05 on 05-07 3.425->3.375 (raise nozzle from platform at z=0)
#x_offset: 21
#y_offset: -11

# Somehow SET_GCODE_VARIABLE is case sensitive. Since Fluidd is using a lowercase Tx macro name, we need this to be lower case, too.
[gcode_macro t5]
variable_spool_id: None
variable_active: False
gcode:
	Tool_Pickup TOOLNUMBER=5
